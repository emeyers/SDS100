---
title: "Class 19 code"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```




```{r}

library(SDS100)


```






$\\$






## Hypothesis test for a single proportion


Does the AstraZeneca vaccine cause blood clots? 


A study found that 79 people experienced clots after receiving a first vaccine dose. 
More than 20 million AstraZeneca vaccines doses had been administered across the UK by the end of March.


About four people in a million would normally be expected to develop this
particular kind of blood clot - though the fact they are so rare makes the 
usual rate hard to estimate.


### Step 1: 
$H_0: \pi$ = 1/1,000,000
$H_A: \pi$ > 1/1,000,000


```{r}


p_hat <-  79/(20 * 10^6) 

n <- 20 * 10^6

pi_0 <- 1/10^6

p_hat <- 79/(20 * 10^6)

SE <- sqrt(   (pi_0  * (1 - pi_0))/n    )

(z_stat <- (p_hat - pi_0)/SE)





# Are these conditions met? 
n * pi_0		 
n * (1 - pi_0) 



# visualize the null distribution

x_vals <- seq(-15, 15, length.out = 1000)

y_vals <- dnorm(x_vals, 0, 1)

plot(x_vals, y_vals, type = "l", xlim = c(-15, 15))


abline(v = z_stat, col = "red")


# get the p-value
pnorm(z_stat, 0, 1, lower.tail = FALSE)


# conclusion!


```




$\\$




## CI for a single proportion


What is the probability of having a blood clot if you take the AstraZeneca vaccine? 

```{r}


z_star <- qnorm(.975)

p_hat - z_star * SE
p_hat + z_star * SE


```



Is it likely you will get a blood clot? 





$\\$




## Confidence interval for a single proportion using the bootstrap


```{r}


library(tictoc)


has_clot <- rep(TRUE, 79)
no_clot <- rep(FALSE, (20 * 10^6) - 79)

data_vec <- c(has_clot, no_clot)



boot_data <- sample(data_vec, replace = TRUE)

boot_proportion <- mean(boot_data)


library(tictoc)

tic()

boot_dist <- do_it(10) * {
  
  boot_data <- sample(data_vec, replace = TRUE)
  boot_proportion <- mean(boot_data)
  
}

toc()



```





$\\$





## Confidence interval for a single mean

How many birds to cats kill? 


A study by Loyd et al (20213) in Biological Conservation, used KittyCams to
record all activity of n = 55 domestic cats that hunt outdoors.

The video footage showed that the mean number of kills per week for these cats
was 2.4 with a standard deviation of 1.51.

Find and interpret a 99% confidence interval for the mean number of kills per
week by US household cats that hunt outdoors.


```{r}


xbar <- 2.4
n <- 55
s = 1.51
t_star <- qt(.995, 54)

2.4 + c(-1, 1) * t_star * s/sqrt(n)


```







$\\$







##  Hypothesis test for a single mean


It is recommended that adults sleep at least 8 hours a night

A Statistics professor asked 12 undergraduate students how much sleep they were
getting and found the average was 6.2 hours with a standard deviation of 1.7
hours.

Assuming this is representative of all students in a Statistics class, does this
provide evidence that students in the class are not getting enough sleep on
average?


```{r}


mu0 <- 8
xbar <- 6.2
n <- 12
s = 1.17
t_star <- qt(.975, 54)

(t_stat <- (xbar - mu0)/(s/sqrt(n)))

pt(t_stat, n-1)


```



  

